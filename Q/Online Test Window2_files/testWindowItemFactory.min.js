define2(["services/testWindowCommonUtils"],function(){angular.module("mettl").register.factory("TestWindowItem",["TestWindowCommonUtils",function(k){function f(c,d){c=angular.extend(c,d);this.StartTime=0;this.InputFormats=[];c.Prepare=function(a,b,c){switch(this.DisplayType){case "LONG_ANSWER":this.HasWordLimit=a.HasWordLimit;this.WordLimit=a.WordLimit;break;case "SS":this.ResourceId=b.ResourceId||a.ResourceId;this.ResourceUrl=b.ResourceUrl||a.ResourceUrl;this.ResourceName=b.ResourceName||a.ResourceName;
break;case "FES":this.QuestionProjectID=a.QuestionProjectId;this.ProjectId=b.ProjectId;this.HasHtml=b.HasHtml||a.HasHtml;this.HasCss=b.HasCss||a.HasCss;this.HasJs=b.HasJs||a.HasJs;this.HasOutput=b.HasOutput||a.HasOutput;break;case "CP":this.QuestionProjectID=a.QuestionProjectId;this.ProjectId=b.ProjectId;this.Language=b.Language||a.Language;this.DbSupportEnabled=b.DbSupportEnabled||a.DbSupportEnabled;this.DbType=b.DbType||a.DbType;this.Database=b.Database||a.Database;break;case "CODE":this.InputFormats=
a.InputFormats;this.Libraries=a.Libraries;this.Languages=a.Languages;this.CodeTemplate=k.htmlDecode(a.CodeTemplate);this.Response=this.Response||this.CodeTemplate;this.CodeLanguage=this.CodeLanguage||a.Languages[0];break;case "SQL":this.Languages=this.Languages||a.Languages;this.CodeLanguage&&"MSSQL_2008_R2"==this.CodeLanguage&&(this.CodeLanguage="MSSQL_2016");this.CodeLanguage=this.CodeLanguage||a.CodeLanguage;this.DefinitionID=this.DefinitionID||this.Question.DefinitionId;break;case "CS":var d=
function(a,b){for(var c=a.Informations,f=[],e=0;e<c.length;e++)f.push(c[e].InfoID);g[a.NodeID]={infos:f,id:a.NodeID,title:a.Title,parentId:b};for(e=0;e<a.Nodes.length;e++)d(a.Nodes[e],a.NodeID)};this.Nodes=angular.fromJson(a.Nodes);this.MaxQueriesAllowed=a.MaxQueriesAllowed;a={};if(this.Response&&this.Response.trim())try{a=angular.fromJson(this.Response)}catch(f){console.log("Error while parsing SQL response",f)}this.OpenedInfos=a.OpenedInfos||[];this.Decision=a.Decision||"";this.TakeDecision=a.TakeDecision||
!1;var g={};for(a=0;a<this.Nodes.length;a++)d(this.Nodes[a],0);this.NodeMap=g;a=[];for(var h in g)b=g[h],a.push([h,b.parentId,b.title]);this.TreeData=a;delete this.Nodes;break;case "R_LANGUAGE":this.Response=null!=this.Response?this.Response:this.Question.CandidateTemplate}return this};c.GetImageCount=function(){return isNaN(this.ImageCount)?0:this.ImageCount};c.DecreaseImageCount=function(a){this.ImageCount&&!isNaN(this.ImageCount)&&--this.ImageCount;return this};return c}return{Decorate:function(c,
d){return f(c,d)},Merge:function(c,d){return angular.extend(d,c)}}}])});