define2("services/testWindowFactory services/testWindowTestStateService services/testWindowSectionService services/testWindowHelperService services/testWindowQuestionService services/gaService".split(" "),function(){angular.module("mettl").register.controller("TestWindowSectionCtrl",["$scope","$stateParams","$state","$log","$timeout","TestWindowFactory","TestWindowSectionService","TestWindowQuestionService","TestWindowHelperService","TestWindowConstants","$q",function(a,c,h,f,k,d,l,m,n,g,p){function q(a){a=
parseInt(a,10);if(0==a)return!1;for(var b=0,b=a-1;0<=b;b--)if(a=d.sections.getByIndex(b),!a.IsComplete()||!a.IsTimed)return!0;return!1}function r(a){a=parseInt(a,10);var b=d.sections.getAll().length-1;if(a==b)return!1;for(var e=0,e=a+1;e<=b;e++)if(a=d.sections.getByIndex(e),!a.IsComplete()||!a.IsTimed)return!0;return!1}f.log("test window section controller called");var b=d.sections.getByIndex(c.s);a.isTaskBasedTest=d.test.isTaskBasedAssessment();!b&&d.test.isPreview()?h.go("testWindow"):(a.section=
b,992>window.screen.width&&(b.IsMultipleQuestions=!1),a.isMultipleQuestions=a.$parent.isMultipleQuestions=b.IsMultipleQuestions,a.$parent.showPrevSection=q(c.s),a.$parent.showNextSection=r(c.s),a.$parent.isLastSection=!a.$parent.showNextSection,a.$parent.prevSection=b,a.$parent.selectedSection=b,a.$parent.sectionTimerEnabled=b.IsTimed,a.$parent.setDropDownSection(b),a.isFixedSectionOrder=d.test.isFixedSectionOrder(),a.goToQuestion=function(b){var c=p.defer();b=parseInt(b,10);m.canGoToQuestion(b).then(function(){h.go("testWindow.section.question",
{i:b,q:a.isMultipleQuestions?98:a.$parent.selectedSection.Items[b].Question.DisplayTypeId});a.$parent.currentPaginationIndex=b+1;c.resolve()})["catch"](function(a){"compulsoryQuestion"===a.mode&&n.Dialogue.ShowAlert({title:RR_COMPULSORY_TEXT_3});f.log(a.msg);c.reject(a.msg)});return c.promise},a.flagForReview=function(b){b.IsFlagged=!b.IsFlagged;a.$emit(g.Events.Question.QuestionFlagged,{category:"buttonRR",action:b.IsFlagged?"questionRevisit":"questionRevisitDel",item:b,data:{qIndex:a.$state.params.i,
qNumber:a.$state.params.i+1,filter:a.currentFilterName}})},a.setAttempted=function(b){a.$broadcast(g.Events.Question.QuestionAttempted,b)},l.startSection(a.section),c=b.CurrentItem?b.CurrentItem:b.Items[0],a.currentItem=c,a.goToQuestion(c.Index).then(function(){console.log("Question switched succefully")})["catch"](function(a){console.log("Error in switching question. Error: ",a)}),a.$parent.currentPaginationIndex=c.Index+1,a.sectionAdjustment=$("#slide-nav").height()+$("#section-pane").height()+
$("#footer").height()+20,f.log("test window section ctrl loading complete..."),a.$on(g.Events.OrientationChange,function(){k(function(){a.$parent.showHeader=!0})}))}])});