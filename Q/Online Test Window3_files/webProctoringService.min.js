define2("services/testWindowTimerService services/testWindowHelperService services/testWindowTestStateService services/testWindowChatService services/testWindowConstants services/testWindowCommonUtils ../constants/proctoringConstants".split(" "),function(){angular.module("mettl").register.service("WebProctoringService",["$log","$http","$rootScope","$timeout","TestWindowTimerService","TestWindowHelperService","TestWindowTestStateService","TestWindowConstants","TestWindowChatService","TestWindowCommonUtils",
"ProctoringConstants",function(u,v,g,p,w,h,a,q,r,x,k){function s(){if(!(a.testState.isTestEnding||l||a.onAnyRetry()))if(a.testState.isWebProctored&&a.testState.blurCount>a.testState.blurLimit)l=!0,a.PRSource="Proctored Finish",m.trigger(m.type.startTestEndProcess,q.TestFinishMode.BrowsingToleranceExceeded);else{var c=TEST_POPUP_NAVIGATED_AWAY_MSG_2,b=a.companyName,d='\x3cspan class\x3d"text-danger"\x3e'+TEST_POPUP_NAVIGATED_AWAY_MSG_3+"\x3c/span\x3e "+TEST_POPUP_NAVIGATED_AWAY_MSG_4;a.testState.isWebProctored&&
(void 0==a.testState.uiSettings||a.testState.uiSettings.ShowRemainingProc)&&(d=TEST_POPUP_NAVIGATED_AWAY_MSG_3+" "+TEST_POPUP_NAVIGATED_AWAY_MSG_5+' \x3cspan class\x3d"text-danger"\x3e'+(a.testState.blurLimit-a.testState.blurCount)+"\x3c/span\x3e "+TEST_POPUP_NAVIGATED_AWAY_MSG_6);n();b&&(c=b);a.testState.isWebProctored&&p(function(){e.Show({title:TEST_POPUP_NAVIGATED_AWAY,modalClass:"model-lg",backgroundClass:"modal-red",actions:[window.BTN_CONTINUE||"Continue"],message:a.candidate.name+TEST_POPUP_NAVIGATED_AWAY_MSG_1+
" "+c+".\x3cbr/\x3e\x3cbr/\x3e"+d,type:e.Type.WARNING,priority:e.Priority.PROC_WARNING,toStopTimer:!1,callback:function(a){e.Hide()}})},100)}}function n(){var b={behaviour:JSON.stringify({CIID:t,BlurCount:a.testState.blurCount,BlurLimit:a.testState.blurLimit,IsWebProctored:a.testState.isWebProctored,IsAllowCopyPaste:a.testState.isAllowCopyPaste,NaviagteTimeOut:c}),saveBehaviour:a.testState.isWebProctored};f=!0;h.AJAXC({url:"/sbweb",method:"POST",data:b,success:function(){c=0;f=!1}})}var b,d=!1,f=
!1,l=!1,e=h.Dialogue,t=a.candidate.id,c=0,m=r.testActions;return{initialize:function(){},ICE:function(){c=(new Date).getTime()-b;d&&b&&1E3<c&&(a.testState.isWebProctored&&a.testState.blurCount++,s());d&&g.$broadcast(k.Events.CANDIDATE_BLUR_IN);d=!1;b=0},OCE:function(){a.testState.crossClickAttempted||(d=!0,b=(new Date).getTime(),g.$broadcast(k.Events.CANDIDATE_BLUR_OUT))},sync:function(){f&&n()}}}])});